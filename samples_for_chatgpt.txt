1. Palo Alto Networks customers receive protections against LockBit 2.0 attacks from Cortex XDR, as well as from the WildFire cloud-delivered security subscription for the Next-Generation Firewall.
2. On February 23rd, a new version of Wiper Malware appeared on VirusTotal. This sample has been detected as Trojan/Worm.Win64.Dropper.AHK.
3. The attackers also used previously undetected malware, including info stealers and keyloggers. In mid-January, the Iran-linked APT35 group has been observed leveraging the Log4Shell flaw to drop a new PowerShell backdoor tracked as CharmPower.
4. A WindTail sample has been identified as having added windtailsrv.exe, which contains code from `C:\Windows\System32\winsvc.dll`. This indicates that the attacker may have compromised one of Microsoft's Windows Management Instrumentation servers (`winmgsrv1`).
5. In April 2021, we also reported on a phishing campaign using contact forms to spread the IcedID banking trojan and Cobalt Strike Beacons. The ISO archive attachment contains a .lnk file and a .log file. The idea here is to evade AV detection by packing the payloads in the archive and having the user manually extract them after download.
6. In 2020, ScreenConnect/ConnectWise has been utilized by the cybercriminal group Pinchy Spider (GOLD SOUTHFIELD, GOLD GARDEN, Sodinokibi, REvil, GandCrab) to distribute Sodinokibi ransomware. Remote desktop management software is a common target and tool used by threat actors because of the wide variety of functionalities they offer.
7. It's a well-known technique used by other threat actors. The payload loads an assembly which is publicly available called IWshRuntimeLibrary.dll and tries to create a LNK file in the target folder giving reference to the running payload's working directory.
8. A Raspberry Robin variant has been delivered via malicious advertisement items that were sent from compromised domains associated with Iranian government entities. This campaign leveraged previously unreported vulnerabilities in Microsoft Exchange Server versions prior to version 2016.
9. The report contains information about how threat actors have evolved their tactics from spam campaigns targeting victims based on geolocation data to more sophisticated attacks leveraging compromised credentials as well as social engineering lures. This document also provides details about new tools being developed by attackers such as Doppel Spider, which can stealthily infect computers without users noticing any activity.
10. For database exfiltration, the actors used a custom tool that could connect to various database types (MySQL, MSSQL, Oracle) and execute pre-defined queries. The tool would chunk and compress the query results before encrypting and exfiltrating them through DNS tunneling.
11. BlackByte ransomware operation has been active since at least July 2021, when it started targeting corporate victims worldwide. This gang is known for exploiting software vulnerabilities (including Microsoft Exchange Server) to gain initial access to their enterprise targets' network.
12. During Night Dragon, threat actors disabled anti-virus and anti-spyware tools in some instances on the victim's machines. The actors also disabled proxy settings to allow direct communication from victims to the Internet.
13. Palo Alto Networks customers receive protections against CVE-2022-22965 and CVE-2022-22963 via products and services including Cortex XDR Prevent and Pro, a Threat Prevention subscription for the Next-Generation Firewall, and Prisma Cloud Compute.
14. The Andromut downloader has been identified as being part of the Flayed Ammyy campaign. It uses CVE-2023-26917 to drop additional payloads on compromised systems.
15. At the time of initial analysis, the domain had stopped resolving; however, we have identified two domains which resolve to the same server as atlanta.com. These domains were registered on January 6th, 2023 at approximately 1pm EST. We believe these registrations occurred after the attacker took control of Atlanta University Network Services Inc.'s network.
16. Reaver has been updated since our last report on its use against Microsoft Exchange servers. It now uses CVE-2023-26851 as well as other vulnerabilities such as CVE-2023-23397. This version contains additional high quality code samples from various threat actors including TrickBot, REvil and Sodinokibi.
17. The SeaDuke backdoor has been found on compromised systems running Windows Server versions prior to version 20H2. It can persist as a service under the name RegKeyRun. This allows attackers to execute commands from any user account without having to log into the system.
18. APT41 used Linux shell commands for system survey and information gathering prior to exploitation of vulnerabilities such as CVE-2019-19871.
19. The DarkComet uses `GetComputerName` API function from Windows SDK v6.0 to retrieve hostname information. It then calls `QuerySystemInformation`, which returns OS version string as well as other useful data such as CPU type, memory size, etc. Finally, it retrieves list of running processes on victim machine and extracts their names.
20. SAP 3D Visual Enterprise Viewer, version - 9, allows a user to open manipulated BMP file received from untrusted sources which results in crashing of the application and becoming temporarily unavailable until the user restarts the application, this is caused due to Improper Input Validation.
21. Unlike newer samples, this one creates a unique file called slooo.exe, which contains code similar to what we have seen before from other APT actors, such as Hafnium. This sample also uses CVE-2023-23397 to drop another executable named mimikatz.
22. Pierogi and Pierogi++ share similarities in code and functionalities, such as strings, reconnaissance techniques, and deployment of decoy documents, some also seen in Micropsia malware. Further, Pierogi++ samples implement in the same order the same backdoor functionalities as Pierogi: taking screenshots, command execution, and downloading attacker-provided files.
23. The attacker deployed historical operations against targets including deploying destructive malware-BlackEnergy. This operation has been attributed to Russia's GRU Unit 649.
24. QuasarRat has been seen being deployed as part of other campaigns such as Operation Bison. It can also be found on compromised websites like those associated with the SolarWinds supply chain attack.
25. We have uncovered a cyberespionage campaign being performed against our client. This activity has been attributed to Russian state sponsored hacking group Fancy Bear. Our investigation into this threat actor indicates they may also operate under another name called Sandworm.
26. After the execution of accevent.exe, it loads event.dll. This file contains code similar to accepter.dll which has been previously seen being loaded into memory after executing PowerShell commands on compromised systems.
27. Our analysis of the latest Maikspy variants revealed that users contracted the spyware from hxxp://miakhalifagame.com/, a website that distributes malicious apps (including the 2016 adult game) and connects to its C&C server to upload data from infected devices and machines.
28. In one example, the user must first click a 'Sign in with Gmail' or 'Sign in with Outlook' button before being presented with a modal asking for their login information. This particular URL was detected as phishing with a score of 0.99998.
29. WeaveScope can install itself on any system without requiring administrator privileges. It will then collect information about all running processes, including those from other vendors like Microsoft Defender, ESET or Sophos.
30. Once inside the network, the actors utilized a combination of built-in tools such as PowerShell and Windows Management Instrumentation (WMI). They also leveraged custom scripts written in Go language. These were designed to perform reconnaissance tasks on systems connected to the Internet through DNS queries.
31. The Emissary configuration is now encrypted using a custom algorithm that uses the srand function to seed the rand function using a value of 2563. This seed value causes the rand function to generate the same values each time, which Emissary will use as a key along with the XOR operation.
32. In March 2021, Microsoft kicked off the patch cycle early after releasing an advisory regarding the mass exploitation of four zero-days vulnerabilities by a Chinese Hacking group, HAFNIUM, on the on-premises versions of the Microsoft Exchange Server.
33. StrongPity has been executed via compromised installation files for legitimate software including compression applications, security software, browsers, file recovery applications, and other tools and utilities.
34. Recently observed COLDRIVER credential phishing domains: Ghostwriter, a Belarusian threat actor, has remained active during the course of the war and recently resumed targeting of Gmail accounts via credential phishing.
35. Spook ransomware has been seen being distributed through phishing emails containing links to compromised websites hosting RTF documents. These files contain macros which download additional payloads from remote servers.
36. All of the backdoors identified - excluding RoyalDNS - required APT15 to create batch scripts in order to install its persistence mechanism. This was achieved through the use of a simple Windows run key. We believe that APT15 could have employed this technique in order to evade behavioural detection, rather than due to a lack of sophistication or development.
37. RTM can use the FindNextUrlCacheEntryA function on Windows systems to enumerate all available URLs from Internet Explorer cache. This allows attacker access to cached pages containing sensitive information such as passwords, credit card numbers, etc.
38. Both campaigns used the same lure and targeted Latin American hotels by email. We found evidence of similar activity that has been ongoing for several months based on the targeted organizations and lure languages (Portuguese and Spanish). This campaign illustrates how OpenDocument text files can be abused to deliver malware through external OLE references with extremely low detection rates.
39. Carbanak payloads have been found on compromised servers belonging to Fin7 members who were also involved in financially motivated attacks against banks around Europe.
40. The Uroburos backdoor has been seen interacting with Windows Defender Antivirus logs on compromised systems. This activity may indicate that the attacker gained access through a vulnerability such as CVE-2023-26851.
41. NJRAT attempts to determine whether the targeted device has a webcam on its network. If so, NJRAT can use the builtin Windows API function GetSystemInfo() to retrieve information about the video card installed on the machine.
42. SecureWorks has been tracking activity from Iranian threat actors since at least mid-2016. This campaign leverages public information about their activities as well as our own knowledge base on these threats. We have seen them targeting organizations across multiple industries including government, education and healthcare.
43. The threat actor used a new variant of the Havoc malware family. This malware is known for its ability to evade detection and provide remote access to compromised systems.
44. RDP and VPN appliances used by employees to access their network were compromised through vulnerabilities such as CVE-2023-26157 and CVE-2023-26158. These attacks allowed attackers to gain full control of these devices.
45. The final stage of operation involves loading a legitimate Windows executable into memory as if it were running on disk. In order to avoid detection, the loader will not load itself directly; instead, it loads another file called `DllMain` which contains the actual entry point.
46. The Sandworm campaign used compromised government accounts to send links to Microsoft Office documents hosted on compromised domains, primarily targeting media organizations in Ukraine.
47. OpenSupdater has been found carrying out reconnaissance on targeted organizations since at least August 2022. It uses legitimate software updates as covert channels to download additional payloads from its Command & Control server.
48. Winnti uses multiple IP addresses on its network. Each one has been identified as belonging to specific threat actors such as Hafnium, which we have seen use these same IP ranges before.
49. A heap buffer overflow occurred in the PrintUDTa() function in mp4box.dll which allowed remote code execution on Windows systems running Microsoft Office 64 bit versions prior to version 2019.
50. For network scanning and enumeration, the attackers leveraged a customized version of Nmap with additional stealth features to avoid detection. The tool used for network scanning and enumeration was a customized version of Nmap. This modified version included additional stealth features which were implemented to help the attackers avoid detection during their reconnaissance activities.
51. Mailto (AKA NetWalker), which has been seen as part of the attack chain against Microsoft Exchange servers since at least early 2021, can deliver various payloads including backdoors such as Emotet and TrickBot.
52. IBM Spectrum Copy Data Management 2.2.13 and earlier has been identified as being vulnerable to remote code execution due to improper handling of file system permissions on Windows systems.
53. Symantec saw attackers dumping credentials and scanning the network using NbtScan. The main malware (pc.exe dubbed mim221) in this campaign was used to dump credentials, and it had the same password as the malware used in the activity documented by SentinelOne.
54. Recently observed Ghostwriter credential phishing domains and emails: Curious Gorge, a group TAG attributes to China's PLA SSF, has remained active against government, military, logistics and manufacturing organizations in Ukraine, Russia and Central Asia.
55. After it finishes encrypting its data, PCclock2 creates a VBS script file which will then execute on the victim machine. This VBS script contains code similar to what would have been executed if the attacker had gained access to the system through a legitimate process such as Windows Update.
56. In the decrypted payload, the malware generates a file path to proceed with the infection: C:\Windows\system32\[random 2 characters]svc.drv. This file is disguised as a legitimate tool named SageThumbs Shell Extension.
57. StrongPity can add directories used by the malware to the Windows Defender exclusions list to prevent detection.
58. Now, KillDisk (detected as RANSOM_KILLDISK.A) has been updated with a ransomware feature that encrypts targeted files and appends them with the string 'do not touch crypted file.' After encryption, it locks out the user and displays a simple ransom note. Other reports show that the KillDisk ransomware component asks for a huge ransom: 222 Bitcoin.
59. As mentioned in the previous report on Operation Earth Kitsune, one of the most active threat actors targeting Japan has been identified as AhnLab Vision.
60. The Intel Processor Trace Capture tool can detect code injection into memory from a remote process running under Windows XP/Vista/Windows Server 2003 R2/Server Core OSes.
61. This activity, first identified by Intel471 and possibly conducted by the group behind Operation Payload Storm, involved compromising multiple organizations through spear phishing emails containing links leading to malicious websites hosting PowerShell scripts designed to download additional files from remote servers.
62. Furthermore, the TrickBot binary used by nworm is encrypted or otherwise encoded when it is retrieved over the Internet. These characteristics are likely an attempt by TrickBot developers to avoid detection. This is the latest in a series of changes in TrickBot as it evolves within our current threat.
63. Nocturnal Stealer utilizes a multi-part HTTP POST form containing stolen information to send to the C&C. This report contains relevant information for tracking infections and managing infected clients such as: HWID, OS, system architecture, and username.
64. The StarBlizzard campaign leveraged two different domains - one hosted on HUBSPOT and another on MAILERLITE. Both were compromised through phishing emails sent from legitimate email accounts belonging to employees at these companies. Once inside their systems, attackers installed backdoors into both services which allowed them access to all user data stored therein as well as remote administration capabilities.
65. We found that the threat actors used vulnerable IIS servers on the network. This allowed them to gain access to sensitive information such as credentials stored in SQL databases.
66. Redline is a tool developed by Kaspersky Lab researcher Sergey Malikov who has been tracking Russian threat actors since at least early 2016. It can perform various reconnaissance tasks on compromised hosts including enumerating files, directories, processes, services, running applications; collecting information about network connections; gathering system configuration data and more.
67. Numerous sources have also told the French IT website LeMagIT that it was Ryuk ransomware threat actors who were behind the attack. This hacking group is known for its TrickBot and BazarLoader infections that allow threat actors to access a compromised network and deploy the Ryuk or Conti ransomware infections.
68. A Drovorub process was discovered hiding behind `svchost` services on Windows systems. This technique allows attackers to evade detection from security products such as SentinelOne.
69. During Operation Dust Storm, the threat actors used a watering hole attack on a popular software reseller to exploit the then-zero-day Internet Explorer vulnerability CVE-2014-0322.
70. Bemstour exploits two Windows vulnerabilities to achieve remote kernel code execution on targeted computers. One vulnerability is a Windows zero-day vulnerability (CVE-2019-0703) discovered by Symantec. The second Windows vulnerability (CVE-2017-0143) was patched in March 2017 after it was discovered to have been used by two exploit tools EternalRomance and EternalSynergy.
71. Once the victim opens the lure document, which includes an image file with a message in Vietnamese asking the victim to enable macros to view the contents of the file. At first glance, the document may look like there is no other content other than the notification to enable macros.
72. DarkSide has been actively targeting Ukrainian government agencies since February 26th. They have also recently attacked Ukraine's Ministry of Defense on March 1st. In addition, they were seen stealing sensitive information from other countries including Georgia, Kazakhstan and Kyrgyz Republic.
73. A few days after the initial compromise, several Lazarus Group malware families gathered a list of running processes on a victim machine. This information was then sent back to their Command & Control server.
74. HeaderTip uses scanning capabilities to identify vulnerable hosts on the network. It then attempts to enumerate all available services running on each host. If any service matches one of the following conditions, it will attempt to connect to them through TCP/IP. This technique can also be leveraged as part of a credential dumping attack against remote systems.
75. The PlugX sample has been identified as being from either Hafnium or Qihoo 360. Both have been associated with Chinese state sponsored hacking operations targeting government entities around the world.
76. This time, however, it looks for and finds the oci.dll. Calling this DLL opens up Shadow Force. This simple technique bypasses forensics tools such as autorun.exe, and makes live detection and remediation more difficult.
77. Ghostwriter has recently been seen targeting organizations in Europe and Asia. Recent activity included spearphishing campaigns against government agencies and financial institutions. In one case, we identified a compromised domain hosting a legitimate website masquerading as a news site from China.
78. The Evil Bunny dropper checks if there are any running processes on the system. If so, it will terminate them all before executing its main function. This ensures that only one process runs at a time when evading detection from antivirus software.
79. Necurs is also known for distributing financially targeted malware and ransomware, cryptomining, and even has a DDoS (distributed denial of service) capability that has not yet been activated but could be at any moment.
80. In the cloud environment, the attacker primarily used stolen API keys and misconfigured IAM roles to move laterally between different cloud services and accounts within the organization.
81. To maintain long-term access the threat actor created multiple backdoor accounts on compromised systems and installed a rootkit on critical servers. They also modified scheduled tasks to execute their malware periodically.
82. To make reverse engineering more difficult, the main payload of Emotet usually applies an obfuscation technique called Control-flow flattening. This technique is used to break the flow of a program's execution by flattening it.
83. The source code used here is a modified version of the RunPE from the NYAN-x-CAT GitHub repository. By using this technique, the author introduces an additional stealthy evasion mechanism. Once the script is done compiling the RunPE code, the PowerShell loads and executes it along.
84. RogueRobin checks the running processes for evidence it may be running in a sandbox environment. It specifically enumerates processes for Wireshark and Sysinternals.
85. Glupteba has been seen as part of the Russian government's efforts to disrupt Ukrainian civil society organizations through targeted attacks on their websites. This attack leveraged multiple vulnerabilities including CVE-2023-26917 which allows remote code execution from any user who can access the admin panel.
86. In particular, these campaigns appear to be related to attacks carried out by APT26. This group has been active since at least early 2019. It uses similar tactics as other Russian state-sponsored hacking operations such as Sandworm, Sofacy and Akademika.
87. This KillDisk variant looks like it is intentionally dropped by another process/attacker. Its file path is hardcoded in the malware (c:\windows\dimens.exe), which means that it is tightly coupled with its installer or is a part of a bigger package. KillDisk also has a self-destruct process, although it isn't really deleting itself.
88. The threat actor achieved persistence by adding a Windows service that executed a Base64-encoded PowerShell command. This command retrieved and executed a payload from a remote server.
89. The attacker uses SideTwist as their primary C2 channel. They have also been seen using ports other than 443 such as 65000 and 65001.
90. During our investigation into the Turla CyberAzov apps, we identified another Android app first seen in the wild in March 2022 that also claimed to conduct DoS attacks against Russian websites.
91. White Atlas attacks have been reported since at least early 2022; however, we do not know if they were conducted as part of any campaign. We believe these attacks may be related to other ongoing operations against Ukraine.
92. The CoinTicker application has been downloaded from a remote server containing two embedded executables named `cointickerdll` and `cryptorig`. Both have been compiled on June 6th at 11:30 AM UTC time.
93. Many of the loaders that we found were used to load Cobalt Strike shellcode by default instead of the BIOPASS RAT malware.
94. The Prometheus variant has died out in recent months, but other variations can continue to rise from the same Thanos base. What changes through each variation is customization. In Prometheus' case, its operators used social engineering well, but were not as adept at working with encryption.
95. How Buckeye obtained Equation Group tools at least a year prior to the Shadow Brokers leak remains unknown. Buckeye disappeared in mid-2017, and three alleged members of the group were indicted in the U.S. in November 2017.
96. Easily accessible files were uploaded from compromised servers on AWS S3 storage. These included .zip archives containing malicious payloads such as Cobalt Strike Beacons.
97. There are two ways the attacker can control the behavior of the backdoored server: through a reverse connect shell or through special commands, all of them triggered via HTTP requests. The HTTP server is equipped with a reverse connect backdoor that can be triggered via a special HTTP GET request.
98. Donut can generate code modules that enable in-memory execution of VBScript, JScript, EXE, DLL, and dotNET payloads.
99. A vulnerability has been identified in AbanteCart prior to version 1.3.2 which allows remote attackers to execute arbitrary code on affected systems due to improper validation of data passed as part of GET requests.
100. Recently observed Turla domains: COLDRIVER, a Russian-based threat actor sometimes referred to as Callisto, continues to use Gmail accounts to send credential phishing emails to a variety of Google and non-Google accounts.
